import numpy as np
import pandas as pd
from pathlib import Path
from Code.pkg.model_training.DLmodels import prepare_pre_vectors, load_model_from_file, get_custom_layers
from Code.pkg.vectors.create_vectors import ElMoVectorizer, GloVeVectorizer
from Code.pkg.vectors.create_features import SentimentAnnotator, PunctuationAnnotator
from keras.utils import CustomObjectScope
from keras.models import load_model
from keras.layers import Activation
import keras.backend as K


class Vectoriser:
    def __init__(self, trained_vectorisers: list):
        """
        Create a vectoriser that can concatenate multiple vector and feature types
        :param trained_vectorisers: a list of trained vectorisers, where all vectorisers contain the transform method
        """
        self.trained_vectorisers = trained_vectorisers

    def transform(self, list_of_strings: list):
        list_of_vectors = [[] for _ in range(len(list_of_strings))]

        for vectoriser in self.trained_vectorisers:
            feature_list = vectoriser.transform(list_of_strings).tolist()

            try:
                feature_list = feature_list.toarray()
            except AttributeError:
                pass

            try:
                feature_list = feature_list.tolist()
            except AttributeError:
                pass


            for idx, feature in enumerate(feature_list):
                list_of_vectors[idx] += feature

        return list_of_vectors


def get_fit_vectoriser(path_to_root: str, vector_type: str, features: list):
    vectorisers = [{'glove': GloVeVectorizer(), 'elmo': ElMoVectorizer()}[vector_type]] \
        if vector_type in {'glove', 'elmo'} else [pd.read_pickle(path_to_root + "/processed_data/vectorisers/" +
                                                                 vector_type + "_vectoriser.pckl")]

    vectorisers += [{'sentiment': SentimentAnnotator(), 'punctuation': PunctuationAnnotator()}[ft]
                    if ft in {'sentiment', 'punctuation'} else
                    pd.read_pickle(path_to_root + "/processed_data/vectorisers/" + ft + "_annotator.pckl")
                    for ft in features]

    return Vectoriser(vectorisers)


def get_attention(text: str, trained_model):
    tokens, sequence = prepare_pre_vectors(text, 'glove', 1, 'attention-lstm')


    get_embedding_layer_output = K.function([trained_model.layers[0].input],
                                      [trained_model.layers[0].output])
    get_attention_layer_output = K.function([trained_model.layers[1].input],
                                            [trained_model.layers[2].output])
    # print(trained_model.summary())
    # print(len(sequence))
    # print(len(sequence[0]))

    get_full_attention = K.function([trained_model.layers[0].input], [trained_model.layers[3].output])
    print(trained_model.layers[3].name)
    attention_output = get_full_attention(sequence)  # 1 x 150
    attention_weights, context_vectors = attention_output.pop(0)

    print(attention_weights)
    print(context_vectors)


    #attention_weights, array = array
    #print(attention_weights)

    exit()
    list_array = attention_weights.tolist()
    tuple_list = []
    for val in range(len(tokens)):
        attention_val = list_array[val]
        token = tokens[val]
        tuple_list.append((attention_val, token))
    print(tuple_list)
    #[(
    # [-0.14162437617778778, -0.43143367767333984, 0.05708997696638107, -0.12938645482063293, -0.1329372376203537, 0.26883694529533386, -0.23887944221496582, -0.06543456017971039, 0.033633992075920105, 0.16421657800674438, -0.004150425083935261, 0.05902010202407837, 0.003269930835813284, 0.022576451301574707, 0.06817426532506943, -0.013640453107655048, 0.05184415355324745, -0.1552683711051941, 0.13392263650894165, 0.059935327619314194, 0.3907245099544525, -0.1811096966266632, 0.013261520303785801, 0.006846551317721605, 0.10103517025709152, 0.019526340067386627, -0.044117726385593414, 0.002861684188246727, -0.055560529232025146, -0.04593744874000549, 0.013145879842340946, -0.03294805809855461, 0.0788564458489418, 0.16995780169963837, -0.12220747023820877, -0.17068397998809814, 0.23520272970199585, -0.207638218998909, 0.21917130053043365, -0.05475998297333717, 0.06339231878519058, -0.06048319861292839, -0.0006479771109297872, -0.05191152170300484, 0.013067617081105709, -0.07170195877552032, 0.18543784320354462, -0.22227947413921356, 0.12647417187690735, -0.2045929729938507, -0.004342947155237198, 0.07260079681873322, -0.00874380860477686, 0.0754036083817482, 0.01920432224869728, -0.05140983313322067, 0.052062973380088806, 0.1591547578573227, -0.03393682464957237, 0.0016260039992630482], 'hi'), ([-0.06847519427537918, -0.3541475236415863, 0.07887325435876846, -0.14572010934352875, -0.03427187725901604, 0.1319940686225891, -0.13560940325260162, -0.06565915793180466, 0.030689619481563568, 0.12085188180208206, -0.0014337488682940602, 0.01862037368118763, -0.026440203189849854, 0.06671673059463501, 0.01912548579275608, -0.016745777800679207, 0.04013611003756523, -0.05940254405140877, 0.13484856486320496, 0.04922470822930336, 0.21075725555419922, -0.09796446561813354, 0.025553587824106216, 0.05017492175102234, 0.09665272384881973, 0.09073641896247864, -0.04019523039460182, -0.010475784540176392, -0.017315750941634178, -0.04434193670749664, 0.0250529944896698, -0.042602382600307465, 0.04683956876397133, 0.11449330300092697, -0.049952857196331024, -0.14046597480773926, 0.15420863032341003, -0.09212800860404968, 0.13532640039920807, -0.06120903044939041, 0.048401232808828354, -0.025202685967087746, -0.013965554535388947, -0.08078879117965698, -0.007287958171218634, -0.04391606152057648, 0.13885654509067535, -0.2313695251941681, 0.11180084943771362, -0.1504233181476593, -0.020607268437743187, 0.05818452313542366, -0.004963285755366087, 0.06397291272878647, -0.002128075808286667, 0.024927359074354172, 0.08433473855257034, 0.1277301162481308, -0.06556500494480133, -0.005135626997798681], 'hi'), ([-0.035485945641994476, -0.32606443762779236, 0.06777835637331009, -0.12145856022834778, -0.007751802448183298, 0.07043856382369995, -0.10057348012924194, -0.04976982995867729, 0.024402117356657982, 0.08003764599561691, -0.0053059859201312065, 0.0027681346982717514, -0.0403699167072773, 0.08885344117879868, -0.002607059432193637, -0.022586362436413765, 0.021506642922759056, -0.02219758741557598, 0.12042238563299179, 0.03385664150118828, 0.1819741576910019, -0.06135071441531181, 0.028352634981274605, 0.07007012516260147, 0.07991474866867065, 0.12879599630832672, -0.016325462609529495, -0.01600770466029644, 0.005693220067769289, -0.0489078015089035, 0.030149957165122032, -0.04971829801797867, 0.037969693541526794, 0.08257951587438583, -0.005513254553079605, -0.11475332826375961, 0.1112300455570221, -0.05924724042415619, 0.10751434415578842, -0.05905305966734886, 0.04000057280063629, -0.007069467566907406, -0.021330825984477997, -0.07418310642242432, -0.013936576433479786, -0.033831123262643814, 0.11218995600938797, -0.24717362225055695, 0.10203641653060913, -0.12203428149223328, -0.03262946009635925, 0.034634459763765335, 0.001343574607744813, 0.04461310803890228, -0.020180707797408104, 0.05785635486245155, 0.07722458243370056, 0.12818720936775208, -0.08056062459945679, -0.0002492075436748564], 'hi'), ([-0.012240004725754261, -0.29943326115608215, 0.05495818704366684, -0.09815468639135361, 0.009282267652451992, 0.032096315175294876, -0.06635407358407974, -0.036559369415044785, 0.016457311809062958, 0.047043900936841965, -0.011556636542081833, -0.010074270889163017, -0.04478135332465172, 0.10290895402431488, -0.01831141859292984, -0.02740788273513317, 0.006681075785309076, 0.003234260017052293, 0.10353030264377594, 0.02672690525650978, 0.15956158936023712, -0.0339583195745945, 0.0304446779191494, 0.07963359355926514, 0.06404202431440353, 0.14750392735004425, -0.0009347823215648532, -0.017467649653553963, 0.02192891575396061, -0.04744812846183777, 0.031204771250486374, -0.054871175438165665, 0.03378390520811081, 0.05640677735209465, 0.02134793810546398, -0.089759461581707, 0.0771084576845169, -0.03761187940835953, 0.08198677003383636, -0.05722428113222122, 0.03304005414247513, 0.006469360552728176, -0.02256474457681179, -0.06676225364208221, -0.01221727579832077, -0.021612493321299553, 0.08559532463550568, -0.2552376091480255, 0.09279226511716843, -0.09615834057331085, -0.03888450935482979, 0.020460858941078186, 0.007767159957438707, 0.03232038766145706, -0.03492233529686928, 0.07517653703689575, 0.06699841469526291, 0.12582582235336304, -0.08672359585762024, 0.008617059327661991], 'hi'), ([0.004200134892016649, -0.27013134956359863, 0.043140918016433716, -0.0761280208826065, 0.020141983404755592, 0.009923511184751987, -0.03549211844801903, -0.02643025480210781, 0.006485842168331146, 0.020334362983703613, -0.018469275906682014, -0.020605426281690598, -0.04228612408041954, 0.11044126003980637, -0.028879301622509956, -0.030290426686406136, -0.00489549245685339, 0.020832611247897148, 0.08450742810964584, 0.025467941537499428, 0.14374059438705444, -0.014065510593354702, 0.03203051537275314, 0.08230743557214737, 0.0517638698220253, 0.1543164700269699, 0.008387121371924877, -0.016852911561727524, 0.033724427223205566, -0.04160846024751663, 0.029781367629766464, -0.05824751406908035, 0.03182398900389671, 0.03508066385984421, 0.03713183477520943, -0.06594438850879669, 0.05070169270038605, -0.023134177550673485, 0.05894835293292999, -0.054708268493413925, 0.02638968639075756, 0.01724465936422348, -0.019018013030290604, -0.05828133597970009, -0.006330546922981739, -0.010157952085137367, 0.0608651302754879, -0.2586595416069031, 0.08247561752796173, -0.07262008637189865, -0.03952062875032425, 0.011447872035205364, 0.013407179154455662, 0.023735444992780685, -0.04729091748595238, 0.08075154572725296, 0.056353867053985596, 0.12017453461885452, -0.08757516741752625, 0.018421612679958344], 'hi'), ([0.01626291684806347, -0.23917923867702484, 0.033170588314533234, -0.05546833574771881, 0.026804767549037933, -0.0016114070313051343, -0.008441811427474022, -0.018901336938142776, -0.0053055165335536, -0.0010235188528895378, -0.024958977475762367, -0.02960542030632496, -0.03486551716923714, 0.11246496438980103, -0.03541598841547966, -0.03104170598089695, -0.014368145726621151, 0.03298790380358696, 0.06438193470239639, 0.028360281139612198, 0.13267768919467926, 0.00044270342914387584, 0.03295571357011795, 0.08009893447160721, 0.042663559317588806, 0.1538619101047516, 0.013564031571149826, -0.015590853057801723, 0.042475342750549316, -0.03267568722367287, 0.026933474466204643, -0.06022793427109718, 0.03140941634774208, 0.018378188833594322, 0.04583662003278732, -0.043664395809173584, 0.03056255541741848, -0.014020941220223904, 0.03832172974944115, -0.051080372184515, 0.019795924425125122, 0.025991512462496758, -0.011941205710172653, -0.04894592985510826, 0.0011700806207954884, -0.00048690050607547164, 0.038966104388237, -0.2587563991546631, 0.07027179002761841, -0.05100509896874428, -0.03531024605035782, 0.005278917495161295, 0.017387395724654198, 0.016891678795218468, -0.05813130363821983, 0.07789269834756851, 0.046535976231098175, 0.1117476224899292, -0.08525926619768143, 0.02743319235742092], 'hi'), ([0.025575721636414528, -0.2076069414615631, 0.0253739096224308, -0.03616369888186455, 0.030514363199472427, -0.006598707754164934, 0.014902012422680855, -0.013587314635515213, -0.018454480916261673, -0.017827678471803665, -0.030549312010407448, -0.03775326907634735, -0.02396356128156185, 0.10988295078277588, -0.03879544883966446, -0.02989044412970543, -0.0227219108492136, 0.04140744358301163, 0.043941956013441086, 0.03400391340255737, 0.12479434162378311, 0.01129104569554329, 0.03312163054943085, 0.0742877945303917, 0.0362800732254982, 0.14891664683818817, 0.015933455899357796, -0.01452970877289772, 0.04912119358778, -0.021634800359606743, 0.023308439180254936, -0.06112052500247955, 0.0323287732899189, 0.00589785585179925, 0.049989406019449234, -0.023172739893198013, 0.015287773683667183, -0.009183096699416637, 0.019660253077745438, -0.04624662548303604, 0.01318051852285862, 0.033098869025707245, -0.0023600112181156874, -0.03886667639017105, 0.008945935405790806, 0.006853737402707338, 0.020398737862706184, -0.25622859597206116, 0.05606112629175186, -0.03099202737212181, -0.027350226417183876, 0.0006166229723021388, 0.01919790916144848, 0.010506262071430683, -0.06805280596017838, 0.0692228376865387, 0.03790786862373352, 0.10121408849954605, -0.08103758096694946, 0.03485126048326492], 'hi'), ([0.03318208456039429, -0.17631687223911285, 0.01974467933177948, -0.0181063711643219, 0.03207661211490631, -0.007905477657914162, 0.0349152572453022, -0.01018828246742487, -0.03237251937389374, -0.030774783343076706, -0.03512357547879219, -0.04557708278298378, -0.010670951567590237, 0.10348134487867355, -0.039713818579912186, -0.027222055941820145, -0.030697744339704514, 0.047351934015750885, 0.023818211629986763, 0.04127774387598038, 0.11883237957954407, 0.01978733204305172, 0.03250216692686081, 0.06570389121770859, 0.0321626253426075, 0.14115314185619354, 0.01640252210199833, -0.014080454595386982, 0.0542730987071991, -0.009245232678949833, 0.019304227083921432, -0.06116227060556412, 0.03455006331205368, -0.0028173511382192373, 0.05118771269917488, -0.004583339672535658, 0.003725833725184202, -0.007870682515203953, 0.0024395862128585577, -0.04025318846106529, 0.006567948963493109, 0.03879474475979805, 0.008927169255912304, -0.028088804334402084, 0.016322987154126167, 0.011686860583722591, 0.005314023699611425, -0.2514475882053375, 0.04015723243355751, -0.012403636239469051, -0.016794424504041672, -0.0032809043768793344, 0.018657458946108818, 0.0037814828101545572, -0.07746715098619461, 0.056793056428432465, 0.03043271042406559, 0.08929033577442169, -0.07566104829311371, 0.0404181070625782], 'hi'), ([0.03972442075610161, -0.1459997147321701, 0.016078175976872444, -0.0011362454388290644, 0.03203953057527542, -0.0074875690042972565, 0.05206882208585739, -0.00845659151673317, -0.04645625501871109, -0.04049497842788696, -0.03874922916293144, -0.05345514044165611, 0.0041411081328988075, 0.09394779801368713, -0.03873385116457939, -0.023436522111296654, -0.03876964747905731, 0.051777150481939316, 0.004528950899839401, 0.04929842799901962, 0.11382647603750229, 0.02687043696641922, 0.031125633046030998, 0.05490301921963692, 0.029878228902816772, 0.13156519830226898, 0.01557950396090746, -0.014355754479765892, 0.05831581726670265, 0.0038898440543562174, 0.015168299898505211, -0.060525376349687576, 0.038062822073698044, -0.008226758800446987, 0.050458874553442, 0.01209195889532566, -0.0050034611485898495, -0.00947414431720972, -0.013780670240521431, -0.03320098668336868, 2.9966782676638104e-05, 0.043240733444690704, 0.021304922178387642, -0.01665557734668255, 0.022975213825702667, 0.01409897394478321, -0.0063705830834805965, -0.24460673332214355, 0.023105857893824577, 0.004820391535758972, -0.004714915528893471, -0.006809270475059748, 0.015846814960241318, -0.0037381944712251425, -0.08662836998701096, 0.04220170900225639, 0.023914558812975883, 0.0766754224896431, -0.069572813808918, 0.044171351939439774], 'molly'), ([0.0455748625099659, -0.11709773540496826, 0.014055892825126648, 0.01492396928369999, 0.03079863451421261, -0.006643701810389757, 0.06682222336530685, -0.008167725056409836, -0.06016026437282562, -0.04756784439086914, -0.041565340012311935, -0.061632927507162094, 0.019744517281651497, 0.08189180493354797, -0.03631816804409027, -0.01888110302388668, -0.047164179384708405, 0.0554143488407135, -0.013508244417607784, 0.05738329142332077, 0.10905638337135315, 0.033176638185977936, 0.029049402102828026, 0.042282264679670334, 0.02901419624686241, 0.120724156498909, 0.013874100521206856, -0.015280229039490223, 0.06147944927215576, 0.017275670543313026, 0.011060124263167381, -0.05933202803134918, 0.04280173406004906, -0.010766474530100822, 0.04848092794418335, 0.026904644444584846, -0.011559044010937214, -0.013435088098049164, -0.029283547773957253, -0.02521263249218464, -0.0063424259424209595, 0.04657373204827309, 0.03428831323981285, -0.004649688955396414, 0.02874935232102871, 0.014354976825416088, -0.014886931516230106, -0.23579908907413483, 0.005539777223020792, 0.020670820027589798, 0.00797106884419918, -0.010171424597501755, 0.011042148806154728, -0.012266990728676319, -0.09566347301006317, 0.026679757982492447, 0.018116969615221024, 0.06400056183338165, -0.06302694231271744, 0.0462927408516407], 'molly'), ([0.05092580243945122, -0.08981715142726898, 0.0133020905777812, 0.030242733657360077, 0.028655685484409332, -0.006202733609825373, 0.07956967502832413, -0.00910008605569601, -0.07303554564714432, -0.05252479016780853, -0.04371621459722519, -0.07024285942316055, 0.035520266741514206, 0.06786345690488815, -0.03285174444317818, -0.013824932277202606, -0.05590531602501869, 0.05881553888320923, -0.029979204759001732, 0.06501678377389908, 0.10399643331766129, 0.03910356014966965, 0.026337286457419395, 0.028152160346508026, 0.029179459437727928, 0.10893775522708893, 0.011569354683160782, -0.016671426594257355, 0.06388682872056961, 0.030497286468744278, 0.007088666781783104, -0.05766981840133667, 0.04861927032470703, -0.010839030146598816, 0.0457150861620903, 0.039940543472766876, -0.01644030213356018, -0.019215894863009453, -0.04417501017451286, -0.01642410084605217, -0.012450898066163063, 0.048919688910245895, 0.04747946932911873, 0.007787975948303938, 0.03357313200831413, 0.012829716317355633, -0.020556559786200523, -0.22505775094032288, -0.011917317286133766, 0.03511525318026543, 0.020531216636300087, -0.013467234559357166, 0.004653227515518665, -0.02184981480240822, -0.10459478199481964, 0.011149473488330841, 0.012817535549402237, 0.05179150030016899, -0.056157082319259644, 0.04701894521713257], 'molly'), ([0.05585162714123726, -0.06417419761419296, 0.013424153439700603, 0.044962093234062195, 0.025850150734186172, -0.006658711936324835, 0.09061991423368454, -0.011024397797882557, -0.08474074304103851, -0.055844664573669434, -0.04531634598970413, -0.07932189106941223, 0.05094991996884346, 0.05236891284584999, -0.028655964881181717, -0.008456490933895111, -0.06487090140581131, 0.062379755079746246, -0.044677041471004486, 0.0718202143907547, 0.09827066957950592, 0.04486510902643204, 0.023044127970933914, 0.012780713848769665, 0.030007442459464073, 0.09635262936353683, 0.008870905265212059, -0.018297065049409866, 0.06558475643396378, 0.04320467263460159, 0.003333697561174631, -0.055604904890060425, 0.05528572201728821, -0.00881210807710886, 0.042484261095523834, 0.051302194595336914, -0.020039070397615433, -0.026297681033611298, -0.05839594081044197, -0.0069854045286774635, -0.01819407381117344, 0.05039453133940697, 0.060537952929735184, 0.020457621663808823, 0.037411801517009735, 0.009951407089829445, -0.023749645799398422, -0.21237729489803314, -0.028708117082715034, 0.04813320189714432, 0.032419245690107346, -0.016742229461669922, -0.0028327666223049164, -0.032414019107818604, -0.11335834860801697, -0.00372933316975832, 0.007829610258340836, 0.040445614606142044, -0.04901634901762009, 0.04659126698970795], 'molly'), ([0.06035067141056061, -0.04005500301718712, 0.01404278352856636, 0.05918660759925842, 0.022575877606868744, -0.008267822675406933, 0.10019548237323761, -0.013701795600354671, -0.09503509849309921, -0.05794786661863327, -0.046435777097940445, -0.08882682770490646, 0.06561794877052307, 0.035881418734788895, -0.023997217416763306, -0.002893254393711686, -0.07384993135929108, 0.06637027114629745, -0.05749963968992233, 0.07752473652362823, 0.09161629527807236, 0.05053685978055, 0.019208598881959915, -0.0035801809281110764, 0.031161464750766754, 0.08302268385887146, 0.0059389895759522915, -0.019914396107196808, 0.06656602025032043, 0.05510617420077324, -0.00014269229723140597, -0.0531916543841362, 0.0625041052699089, -0.005022547673434019, 0.03901928290724754, 0.061099715530872345, -0.02267657220363617, -0.03418970853090286, -0.0717523843050003, 0.0029374875593930483, -0.023469146341085434, 0.0511009618639946, 0.07316377758979797, 0.03311179578304291, 0.04025138542056084, 0.006154811009764671, -0.024857010692358017, -0.19772769510746002, -0.0443694181740284, 0.05973636358976364, 0.0432577058672905, -0.02001178078353405, -0.010901281610131264, -0.043806418776512146, -0.12182102352380753, -0.01751607283949852, 0.003007995430380106, 0.03022434376180172, -0.041602104902267456, 0.04522966593503952], 'molly'), ([0.06437373161315918, -0.017275113612413406, 0.014814497902989388, 0.07297706604003906, 0.018990131095051765, -0.011117867194116116, 0.10844185203313828, -0.016888553276658058, -0.10376119613647461, -0.059192415326833725, -0.04709845408797264, -0.09864744544029236, 0.07921408116817474, 0.018848104402422905, -0.01909249648451805, 0.0028025766368955374, -0.08259344846010208, 0.07092846930027008, -0.06843870878219604, 0.08194813132286072, 0.08385758846998215, 0.05609307438135147, 0.014853515662252903, -0.020679034292697906, 0.03234167397022247, 0.06895754486322403, 0.0029076188802719116, -0.021296557039022446, 0.06678659468889236, 0.0659659132361412, -0.003290171269327402, -0.05047905817627907, 0.06993225961923599, 0.00021701485093217343, 0.035485878586769104, 0.06944704055786133, -0.024626189842820168, -0.042441703379154205, -0.08395577222108841, 0.013162843883037567, -0.028173405677080154, 0.05112554505467415, 0.08508995920419693, 0.04547322168946266, 0.042095281183719635, 0.0018441430293023586, -0.024270864203572273, -0.18106648325920105, -0.05853927135467529, 0.06997517496347427, 0.0528114028275013, -0.023271817713975906, -0.01905311644077301, -0.05581985041499138, -0.1297978013753891, -0.029946433380246162, -0.0017524792347103357, 0.021260084584355354, -0.033873919397592545, 0.04312150925397873], 'molly'), ([0.06784339994192123, 0.004370139911770821, 0.015447254292666912, 0.08634787052869797, 0.015219437889754772, -0.015178410336375237, 0.1154407262802124, -0.02034524828195572, -0.11082487553358078, -0.059873100370168686, -0.04728876054286957, -0.10861916095018387, 0.09152986109256744, 0.0016924729570746422, -0.014113741926848888, 0.008606084622442722, -0.09085404127836227, 0.07608789950609207, -0.07756153494119644, 0.0849757120013237, 0.0748884454369545, 0.06143754720687866, 0.009991499595344067, -0.03825553134083748, 0.033292256295681, 0.054157666862010956, -0.00010525520337978378, -0.022249635308980942, 0.0661807730793953, 0.07560206949710846, -0.00606728857383132, -0.04751375690102577, 0.07720790058374405, 0.006610887125134468, 0.032000504434108734, 0.07645968347787857, -0.026125125586986542, -0.0506548173725605, -0.09466663748025894, 0.023496245965361595, -0.032206811010837555, 0.05053793266415596, 0.09608052670955658, 0.05725494399666786, 0.04296615347266197, -0.0026332768611609936, -0.022370966151356697, -0.16235460340976715, -0.0709519013762474, 0.07893507182598114, 0.06095796823501587, -0.026503194123506546, -0.026838393881917, -0.06821238249540329, -0.13706964254379272, -0.040890902280807495, -0.00652097724378109, 0.013574001379311085, -0.02576945349574089, 0.040418487042188644], 'molly'), ([0.07066729664802551, 0.025067787617444992, 0.01570962555706501, 0.09926772862672806, 0.011364053003489971, -0.02033773995935917, 0.12122378498315811, -0.023847751319408417, -0.11617634445428848, -0.06022385135293007, -0.04696277901530266, -0.11853542923927307, 0.10244789719581604, -0.015186580829322338, -0.009192224591970444, 0.014511903747916222, -0.0984131321310997, 0.0817902684211731, -0.08498901128768921, 0.0865454226732254, 0.06466292589902878, 0.06642993539571762, 0.004633657168596983, -0.05603580176830292, 0.03380729630589485, 0.03864070773124695, -0.002993508707731962, -0.0226232148706913, 0.06467491388320923, 0.08388469368219376, -0.008440209552645683, -0.04434101656079292, 0.0839734822511673, 0.013874134048819542, 0.028640249744057655, 0.08225296437740326, -0.027378370985388756, -0.05848957970738411, -0.1035374253988266, 0.0337362214922905, -0.03547580540180206, 0.04939241334795952, 0.10593153536319733, 0.06817982345819473, 0.04290834069252014, -0.007002050057053566, -0.019514160230755806, -0.1415766328573227, -0.08142701536417007, 0.08672644197940826, 0.06766021996736526, -0.029674021527171135, -0.03388054296374321, -0.08072217553853989, -0.14340126514434814, -0.05031706392765045, -0.011335259303450584, 0.007100410293787718, -0.017220256850123405, 0.037238117307424545], 'molly'), ([0.07274752110242844, 0.04496214538812637, 0.01543416641652584, 0.1116630807518959, 0.007502142805606127, -0.026430971920490265, 0.1257859766483307, -0.027197768911719322, -0.11979572474956512, -0.06042294576764107, -0.046061668545007706, -0.128160759806633, 0.11192546039819717, -0.03141873702406883, -0.004423496313393116, 0.0205185879021883, -0.10509621351957321, 0.08790412545204163, -0.09087370336055756, 0.08663704991340637, 0.053191348910331726, 0.07090896368026733, -0.0012012162478640676, -0.07373160868883133, 0.03373420611023903, 0.022460443899035454, -0.005662037990987301, -0.022316167131066322, 0.06220052391290665, 0.09073231369256973, -0.010382373817265034, -0.041004031896591187, 0.0898987203836441, 0.021728655323386192, 0.0254499614238739, 0.08693917095661163, -0.028558392077684402, -0.06567071378231049, -0.11025127023458481, 0.0436815470457077, -0.03789825364947319, 0.047731395810842514, 0.11447242647409439, 0.0779976099729538, 0.041988782584667206, -0.011062941513955593, -0.016026237979531288, -0.11876621097326279, -0.08985807746648788, 0.09347204118967056, 0.07294286787509918, -0.03274213522672653, -0.03989023715257645, -0.0930798202753067, -0.14855828881263733, -0.05825772508978844, -0.01620606705546379, 0.0017134388908743858, -0.008167454041540623, 0.033667173236608505], 'cool'), ([0.0739876925945282, 0.06414128094911575, 0.014516067691147327, 0.12342455238103867, 0.003693927777931094, -0.03326216712594032, 0.1290973573923111, -0.0302311759442091, -0.12168338894844055, -0.060599684715270996, -0.04452555999159813, -0.13724419474601746, 0.11997520923614502, -0.04666849225759506, 0.00012692618474829942, 0.026616282761096954, -0.11077865213155746, 0.09424571692943573, -0.09538061171770096, 0.0852648913860321, 0.04053967446088791, 0.07471270859241486, -0.007478851359337568, -0.09104350954294205, 0.03297429904341698, 0.005718784872442484, -0.008027549833059311, -0.0212787427008152, 0.05870566517114639, 0.09610738605260849, -0.011874685063958168, -0.03754262626171112, 0.09469928592443466, 0.029902298003435135, 0.022448373958468437, 0.09062423557043076, -0.029802994802594185, -0.07198880612850189, -0.11455421149730682, 0.05313929170370102, -0.039408981800079346, 0.045589808374643326, 0.12156741321086884, 0.08649864047765732, 0.04029533267021179, -0.014688212424516678, -0.012195768766105175, -0.0940331518650055, -0.09620211273431778, 0.09929482638835907, 0.07687361538410187, -0.03565840423107147, -0.044670119881629944, -0.10501963645219803, -0.1523222029209137, -0.06478578597307205, -0.021121155470609665, -0.0027475019451230764, 0.001423582318238914, 0.029765918850898743], 'cool'), ([0.0742984414100647, 0.08263320475816727, 0.012908396311104298, 0.13441574573516846, -1.4332711543829646e-05, -0.04062201827764511, 0.13111403584480286, -0.032822925597429276, -0.12185504287481308, -0.06084180995821953, -0.042306337505578995, -0.14553327858448029, 0.12664631009101868, -0.060642555356025696, 0.004417260177433491, 0.03277825936675072, -0.11538504809141159, 0.10060103237628937, -0.09867231547832489, 0.08247317373752594, 0.026829589158296585, 0.07769584655761719, -0.014144651591777802, -0.10766807943582535, 0.03148047998547554, -0.011429601348936558, -0.010019728913903236, -0.019511638209223747, 0.054164618253707886, 0.10001109540462494, -0.012906048446893692, -0.03399207442998886, 0.09815026074647903, 0.038131266832351685, 0.019634151831269264, 0.0934046283364296, -0.03121344745159149, -0.07729939371347427, -0.11628052592277527, 0.06193273141980171, -0.039965253323316574, 0.042999766767024994, 0.1271156668663025, 0.09352349489927292, 0.03793294355273247, -0.017810802906751633, -0.008269892074167728, -0.06758805364370346, -0.1004718542098999, 0.10430755466222763, 0.07954898476600647, -0.038370903581380844, -0.04811219871044159, -0.11629022657871246, -0.15450337529182434, -0.06999558210372925, -0.02604915201663971, -0.006455633789300919, 0.011551016941666603, 0.02557232230901718], 'cool'), ([0.0736023560166359, 0.10040933638811111, 0.01061515137553215, 0.14448383450508118, -0.003586652223020792, -0.04830183461308479, 0.13178786635398865, -0.034888215363025665, -0.12034042179584503, -0.061202943325042725, -0.03937822952866554, -0.1527874916791916, 0.13200724124908447, -0.07309753447771072, 0.008423014543950558, 0.03895653784275055, -0.11888416111469269, 0.1067473441362381, -0.10089916735887527, 0.0783330574631691, 0.01223697792738676, 0.07974332571029663, -0.02112250216305256, -0.12330875545740128, 0.029252370819449425, -0.028780385851860046, -0.01158214546740055, -0.01706221140921116, 0.04858478158712387, 0.10247796773910522, -0.013473953120410442, -0.030382294207811356, 0.10009435564279556, 0.04616548866033554, 0.01699196919798851, 0.09536449611186981, -0.03285382315516472, -0.08151978999376297, -0.11537011712789536, 0.06990832090377808, -0.039551615715026855, 0.039994534105062485, 0.13105130195617676, 0.09896896779537201, 0.03501785174012184, -0.0204103235155344, -0.0044521368108689785, -0.039757728576660156, -0.1027296856045723, 0.10860530287027359, 0.08108346909284592, -0.040829405188560486, -0.050189558416604996, -0.1266644448041916, -0.15495124459266663, -0.07399007678031921, -0.03094332478940487, -0.009579244069755077, 0.022168194875121117, 0.021106213331222534], 'cool'), ([0.07183798402547836, 0.11739422380924225, 0.007683164440095425, 0.15347141027450562, -0.006994187831878662, -0.05610426887869835, 0.1310756951570511, -0.036380406469106674, -0.11718489229679108, -0.06170942261815071, -0.03574547544121742, -0.15879088640213013, 0.13613280653953552, -0.08384651690721512, 0.0121308583766222, 0.045081403106451035, -0.1212824285030365, 0.11247273534536362, -0.1021936684846878, 0.07294057309627533, -0.0030133898835629225, 0.08077993988990784, -0.028317244723439217, -0.13768912851810455, 0.02632947824895382, -0.04609007015824318, -0.012672659941017628, -0.014018071815371513, 0.04201045259833336, 0.10357018560171127, -0.013584942556917667, -0.02673787623643875, 0.10044516623020172, 0.05377631634473801, 0.014498581178486347, 0.09657423198223114, -0.03475239500403404, -0.0846238061785698, -0.11187811940908432, 0.07694122195243835, -0.038182977586984634, 0.03661153465509415, 0.13334280252456665, 0.10278993099927902, 0.03167092055082321, -0.022498559206724167, -0.000902305415365845, -0.010985273867845535, -0.10308239609003067, 0.11226072162389755, 0.0816013365983963, -0.04298961162567139, -0.05094462260603905, -0.1359478086233139, -0.15356191992759705, -0.07687254995107651, -0.03574545308947563, -0.012269062921404839, 0.033180370926856995, 0.016373394057154655], 'cool'), ([0.06896352767944336, 0.13347910344600677, 0.004193495959043503, 0.16122815012931824, -0.010212949477136135, -0.06385093182325363, 0.1289474070072174, -0.0372861884534359, -0.11245191842317581, -0.06236651912331581, -0.031446367502212524, -0.1633632332086563, 0.13909469544887543, -0.09276336431503296, 0.015533328987658024, 0.051064252853393555, -0.12261682748794556, 0.11759191751480103, -0.10266846418380737, 0.0664139911532402, -0.01865818351507187, 0.08077530562877655, -0.03562036529183388, -0.15056680142879486, 0.02278296835720539, -0.06309263408184052, -0.013263321481645107, -0.010498265735805035, 0.03452296555042267, 0.10337222367525101, -0.013254748657345772, -0.023078424856066704, 0.09918565303087234, 0.06076519563794136, 0.012128432281315327, 0.09709011018276215, -0.03690490126609802, -0.0866343304514885, -0.10597597062587738, 0.08293907344341278, -0.035905689001083374, 0.03289392217993736, 0.13399215042591095, 0.10499770939350128, 0.028010619804263115, -0.02410639449954033, 0.002261795336380601, 0.018189119175076485, -0.10167576372623444, 0.11532200127840042, 0.08123017102479935, -0.0448167622089386, -0.050475165247917175, -0.14398536086082458, -0.15028296411037445, -0.07874196022748947, -0.04038984328508377, -0.014650363475084305, 0.04444713890552521, 0.011369626969099045], 'cool'), ([0.06495960056781769, 0.14853772521018982, 0.00025256132357753813, 0.16762246191501617, -0.013222464360296726, -0.07138728350400925, 0.12539301812648773, -0.03761948272585869, -0.1062261313199997, -0.06316398829221725, -0.026553558185696602, -0.16636905074119568, 0.1409558206796646, -0.09978435188531876, 0.018624767661094666, 0.056803155690431595, -0.1229480430483818, 0.12195748835802078, -0.10241630673408508, 0.05889030173420906, -0.03441091254353523, 0.07974416017532349, -0.042917728424072266, -0.16174596548080444, 0.018706701695919037, -0.07952013611793518, -0.013339929282665253, -0.006642622407525778, 0.026237184181809425, 0.10198510438203812, -0.012507949024438858, -0.019419191405177116, 0.09636297821998596, 0.06697200983762741, 0.009858482517302036, 0.09695512801408768, -0.03927963599562645, -0.0876144990324974, -0.09794306010007858, 0.0878436267375946, -0.03279593959450722, 0.028890904039144516, 0.1330336183309555, 0.10565511882305145, 0.02414671704173088, -0.02527337335050106, 0.0049610743299126625, 0.04716654121875763, -0.09868812561035156, 0.11781307309865952, 0.0800955519080162, -0.04628811404109001, -0.04891936853528023, -0.15066581964492798, -0.14511573314666748, -0.07969013601541519, -0.04480741545557976, -0.016819395124912262, 0.055790625512599945, 0.006084624212235212], 'cool'), ([0.059831149876117706, 0.16244277358055115, -0.004016857594251633, 0.17255136370658875, -0.016005540266633034, -0.07858547568321228, 0.12042776495218277, -0.0374147929251194, -0.09861510992050171, -0.06408102065324783, -0.02117050252854824, -0.16772377490997314, 0.14176812767982483, -0.10490597784519196, 0.021398793905973434, 0.06219013035297394, -0.12235438078641891, 0.1254662275314331, -0.10151182115077972, 0.050520263612270355, -0.049981094896793365, 0.077742800116539, -0.05009813234210014, -0.17108683288097382, 0.014208188280463219, -0.09512415528297424, -0.012901301495730877, -0.0026000123471021652, 0.01729455590248108, 0.09952105581760406, -0.011377038434147835, -0.015771429985761642, 0.09208009392023087, 0.0722816213965416, 0.007671937812119722, 0.09620101004838943, -0.041823893785476685, -0.08765728771686554, -0.08814872056245804, 0.09163051098585129, -0.02895536832511425, 0.024656863883137703, 0.13053171336650848, 0.10486844927072525, 0.02017497643828392, -0.02604016102850437, 0.007150732446461916, 0.07534120976924896, -0.09432248771190643, 0.11973558366298676, 0.0783165916800499, -0.04739421606063843, -0.04644080623984337, -0.15592308342456818, -0.138114795088768, -0.0798008143901825, -0.04892978072166443, -0.018843406811356544, 0.06700850278139114, 0.0005058423848822713], 'cool'), ([0.053607966750860214, 0.1750807911157608, -0.00848460104316473, 0.17594818770885468, -0.018548930063843727, -0.08534519374370575, 0.11409533768892288, -0.03672086447477341, -0.0897493064403534, -0.0650906041264534, -0.015424794517457485, -0.1673974096775055, 0.1415727138519287, -0.10817991197109222, 0.023847373202443123, 0.06711938232183456, -0.12092605978250504, 0.1280607283115387, -0.1000133752822876, 0.041462063789367676, -0.06509455293416977, 0.07486187666654587, -0.0570613294839859, -0.178510844707489, 0.00939981173723936, -0.10969480872154236, -0.011958331800997257, 0.0014833807945251465, 0.007853677496314049, 0.09609778225421906, -0.009901014156639576, -0.012142292223870754, 0.0864851325750351, 0.07662723958492279, 0.005560648627579212, 0.094850555062294, -0.0444711372256279, -0.08687478303909302, -0.07702522724866867, 0.09430698305368423, -0.024504374712705612, 0.020249629393219948, 0.12657830119132996, 0.10277777910232544, 0.016173621639609337, -0.026444023475050926, 0.008815133944153786, 0.10215577483177185, -0.08879726380109787, 0.12107202410697937, 0.0760023295879364, -0.04813899099826813, -0.04321416839957237, -0.15973566472530365, -0.12938453257083893, -0.07914905995130539, -0.05269317701458931, -0.020763332024216652, 0.07789011299610138, -0.005378116387873888], 'lol'), ([0.04634394869208336, 0.18636395037174225, -0.013021891005337238, 0.17778810858726501, -0.02084466442465782, -0.09159363806247711, 0.10646825283765793, -0.03559521213173866, -0.07977962493896484, -0.06616362184286118, -0.009458966553211212, -0.16541479527950287, 0.140401691198349, -0.10970497131347656, 0.025961218401789665, 0.0714951828122139, -0.11876022815704346, 0.12972691655158997, -0.0979653149843216, 0.03187425434589386, -0.07951192557811737, 0.07121726870536804, -0.06372441351413727, -0.18400095403194427, 0.004391096998006105, -0.12307483702898026, -0.010532806627452374, 0.00547454971820116, -0.0019205673597753048, 0.09183314442634583, -0.008123449981212616, -0.008534440770745277, 0.07975888252258301, 0.07999026030302048, 0.0035261050797998905, 0.0929202139377594, -0.04714830219745636, -0.08538758009672165, -0.06503415107727051, 0.0959082618355751, -0.019573673605918884, 0.015728315338492393, 0.12128791958093643, 0.09954570978879929, 0.012201528064906597, -0.026516463607549667, 0.009962341748178005, 0.1271488070487976, -0.08233636617660522, 0.12179016321897507, 0.07324888557195663, -0.04853864014148712, -0.03941246122121811, -0.16212345659732819, -0.119072824716568, -0.07780151069164276, -0.05604201555252075, -0.022598272189497948, 0.08823329955339432, -0.011574769392609596], 'lol'), ([0.03811481595039368, 0.19623763859272003, -0.01750926859676838, 0.17809005081653595, -0.022891545668244362, -0.0972844734787941, 0.0976458415389061, -0.03409957513213158, -0.06887251138687134, -0.06727216392755508, -0.0034200730733573437, -0.16185268759727478, 0.13828063011169434, -0.10961737483739853, 0.027731239795684814, 0.07523871213197708, -0.1159561350941658, 0.1304888129234314, -0.09539994597434998, 0.02190873958170414, -0.09304235130548477, 0.06693980097770691, -0.07002592086791992, -0.1875978261232376, -0.0007179206004366279, -0.13516654074192047, -0.008655860088765621, 0.009261869825422764, -0.011867807246744633, 0.08684010803699493, -0.006090321112424135, -0.004945389926433563, 0.07210148125886917, 0.08239629119634628, 0.001579062081873417, 0.09042254835367203, -0.04978269711136818, -0.08331556618213654, -0.05263028293848038, 0.09649266302585602, -0.014295420609414577, 0.011150897480547428, 0.11479255557060242, 0.09534621238708496, 0.008298233151435852, -0.026282604783773422, 0.010618588887155056, 0.14998576045036316, -0.07515913248062134, 0.12184745073318481, 0.07013773918151855, -0.04861971363425255, -0.03519653528928757, -0.16314314305782318, -0.10736194252967834, -0.07581684738397598, -0.05893196538090706, -0.02435065619647503, 0.09785949438810349, -0.01808590441942215], 'lol'), ([0.02901468798518181, 0.2046828716993332, -0.021843241527676582, 0.1769159734249115, -0.024696357548236847, -0.10239622741937637, 0.08774994313716888, -0.03229635953903198, -0.05720320716500282, -0.06839228421449661, 0.002550707897171378, -0.1568344235420227, 0.1352313756942749, -0.10807998478412628, 0.029150282964110374, 0.07829300314188004, -0.11261112987995148, 0.13040126860141754, -0.09233953803777695, 0.011704724282026291, -0.10555080324411392, 0.062165454030036926, -0.07592730969190598, -0.18939203023910522, -0.005841569975018501, -0.14593206346035004, -0.006366084795445204, 0.012760237790644169, -0.021841533482074738, 0.08122247457504272, -0.003847744083032012, -0.0013671416090801358, 0.0637190192937851, 0.08390791714191437, -0.0002619739098008722, 0.08736786991357803, -0.05230773240327835, -0.08077037334442139, -0.040228404104709625, 0.09613607078790665, -0.008794917725026608, 0.006572064012289047, 0.10723463445901871, 0.09035394340753555, 0.004485448822379112, -0.02576146461069584, 0.010823000222444534, 0.17046938836574554, -0.0674712061882019, 0.12119631469249725, 0.06673499196767807, -0.04841648042201996, -0.030707374215126038, -0.16288238763809204, -0.09445786476135254, -0.07324659079313278, -0.06133207678794861, -0.02601141482591629, 0.10662494599819183, -0.024906758219003677], 'lol'), ([0.019151635468006134, 0.2117146998643875, -0.02594095468521118, 0.174366757273674, -0.026274407282471657, -0.1069299578666687, 0.07691880315542221, -0.030245833098888397, -0.044947899878025055, -0.06950583308935165, 0.008327184244990349, -0.1505216807126999, 0.13127431273460388, -0.1052718535065651, 0.030214903876185417, 0.08062586933374405, -0.10881704092025757, 0.12954211235046387, -0.088797926902771, 0.0013844930799677968, -0.11695858091115952, 0.05702679231762886, -0.08141215890645981, -0.18951447308063507, -0.01091174315661192, -0.1553872525691986, -0.003707312047481537, 0.015912994742393494, -0.031716085970401764, 0.0750718042254448, -0.0014398035127669573, 0.0022136555053293705, 0.054811395704746246, 0.08461572974920273, -0.0019730771891772747, 0.08376546204090118, -0.05466748774051666, -0.07785044610500336, -0.02817758172750473, 0.09492632746696472, -0.003183925524353981, 0.002041381783783436, 0.09876038879156113, 0.08473560959100723, 0.0007697950932197273, -0.02496664971113205, 0.010622788220643997, 0.18853166699409485, -0.05945708602666855, 0.11978835612535477, 0.06309190392494202, -0.047968052327632904, -0.026061395183205605, -0.16145366430282593, -0.08057858794927597, -0.07013625651597977, -0.06322606652975082, -0.027564555406570435, 0.11442713439464569, -0.03202616050839424], 'lol'), ([0.008642686530947685, 0.21737751364707947, -0.02974264696240425, 0.1705760806798935, -0.027649153023958206, -0.11090651899576187, 0.06530007719993591, -0.028003983199596405, -0.03227594867348671, -0.07060152292251587, 0.013805008493363857, -0.1431046575307846, 0.1264299750328064, -0.10137857496738434, 0.03092653676867485, 0.08223021775484085, -0.10465725511312485, 0.12800480425357819, -0.08478191494941711, -0.008948847651481628, -0.1272384226322174, 0.05164642259478569, -0.08648347854614258, -0.1881251037120819, -0.015879200771450996, -0.16359156370162964, -0.000726197031326592, 0.01869088038802147, -0.041390787810087204, 0.06846532225608826, 0.0010932576842606068, 0.005814926698803902, 0.04556211084127426, 0.0846283957362175, -0.003527646651491523, 0.07962391525506973, -0.05681951716542244, -0.0746382623910904, -0.01674589328467846, 0.0929579958319664, 0.00244367984123528, -0.0023979386314749718, 0.08951318264007568, 0.0786430761218071, -0.0028538715559989214, -0.023907138034701347, 0.010069013573229313, 0.20421259105205536, -0.0512748584151268, 0.11757855862379074, 0.05924619361758232, -0.047315504401922226, -0.021348660811781883, -0.1589878648519516, -0.06594283878803253, -0.06652667373418808, -0.06461253762245178, -0.02899080701172352, 0.12120626866817474, -0.03942754864692688], 'lol'), ([-0.0023913041222840548, 0.22173839807510376, -0.03321193903684616, 0.1657024323940277, -0.028851190581917763, -0.11436371505260468, 0.05304378643631935, -0.025621002539992332, -0.019343135878443718, -0.07167497277259827, 0.01890569180250168, -0.1347915381193161, 0.1207200437784195, -0.09658417850732803, 0.031291961669921875, 0.08312279731035233, -0.10020481050014496, 0.12589147686958313, -0.0802924633026123, -0.01921158842742443, -0.13640588521957397, 0.04613257944583893, -0.09115976095199585, -0.18540234863758087, -0.020713381469249725, -0.17063619196414948, 0.0025301652494817972, 0.021088754758238792, -0.050791386514902115, 0.061465177685022354, 0.003716423874720931, 0.009457802399992943, 0.03613074868917465, 0.08406328409910202, -0.004899120423942804, 0.07495102286338806, -0.05873626470565796, -0.07119974493980408, -0.006116371601819992, 0.09032770246267319, 0.008013849146664143, -0.006709696725010872, 0.07962770760059357, 0.07220912724733353, -0.00639888271689415, -0.022587796673178673, 0.009213174693286419, 0.21763278543949127, -0.043053459376096725, 0.11452819406986237, 0.05522420257329941, -0.04649929702281952, -0.01663355343043804, -0.15562821924686432, -0.05076035112142563, -0.062455154955387115, -0.06550423800945282, -0.03027031011879444, 0.12694261968135834, -0.0470905601978302], 'lol'), ([-0.013830580748617649, 0.22488094866275787, -0.036334328353405, 0.15992054343223572, -0.0299166738986969, -0.11735270172357559, 0.04029558226466179, -0.023140130564570427, -0.006286669056862593, -0.07272831350564957, 0.023577792569994926, -0.12579751014709473, 0.11416740715503693, -0.09106477349996567, 0.031323131173849106, 0.08334112912416458, -0.09552104771137238, 0.12330763787031174, -0.07532541453838348, -0.02933822013437748, -0.1445091962814331, 0.04057690128684044, -0.0954708456993103, -0.18153338134288788, -0.025400714948773384, -0.17663218080997467, 0.0060164108872413635, 0.023121008649468422, -0.05986921116709709, 0.05411882326006889, 0.006400773301720619, 0.013165042735636234, 0.026648567989468575, 0.08303830772638321, -0.006063336972147226, 0.06975316256284714, -0.06040511652827263, -0.06758519262075424, 0.003607603022828698, 0.08713041990995407, 0.013472099788486958, -0.010864743031561375, 0.06922585517168045, 0.0655452311038971, -0.009883423335850239, -0.021009737625718117, 0.008104515261948109, 0.2289656698703766, -0.034892283380031586, 0.11060667037963867, 0.05104308947920799, -0.04555719718337059, -0.011957165785133839, -0.151524618268013, -0.0352240689098835, -0.05795670300722122, -0.06592640280723572, -0.031384460628032684, 0.13165123760700226, -0.054992932826280594]
    # , 'lol')]
    # hi hi hi hi hi hi hi hi molly molly molly molly molly molly molly molly is is is is is is is is lol lol lol lol lol lol lol lol


    # print(get_full_attention([sequence]))

    # sentence_word_embeddings = get_embedding_layer_output([sequence])
    # get_attention_layer_output(array)


    return
    # print(sentence_word_embeddings[0][0])
    # print(len(sentence_word_embeddings))
    # print(len(sentence_word_embeddings[0]))
    # print(len(sentence_word_embeddings[0][0]))

    # -----------------------------------------------
    print(get_embedding_layer_output([sequence])[0])



    # for vec in sentence_word_embeddings[0][0]:
    #     if np.count_nonzero(vec) > 0:
    #         array = np.array([[vec] + [np.zeros(50) for _ in range(149)]])
    #         attention_output = get_attention_layer_output(array)
    #         print(attention_output)

        # print(sentence_word_embeddings[0][0][i].shape)
        # print(model.layers[1].input.shape)
        # attention = get_attention_layer_output([sentence_word_embeddings[0][0][i]])
        # print(attention)
        # print(tokens[i])
    return


def get_prediction(text: str, trained_model, d_num, m_name):
    tokens, sequence = prepare_pre_vectors(text, 'glove', d_num, m_name)
    prediction = trained_model.predict(sequence)
    return prediction


def get_trained_model(path_to_root: str, vector_type: str, feature_types: list, model_name: str, dataset_number: int):
    base_path = Path(__file__).parent
    ml_models = {"Support Vector Machine",
                 "Logistic Regression",
                 "Random Forest Classifier",
                 "Gaussian Naive Bayes",
                 "K-Means"}
    dl_models = {'cnn', 'attention-lstm'}

    if model_name in ml_models:
        vectoriser = get_fit_vectoriser(path_to_root, vector_type, feature_types)
        # TODO get ml_model with correct feature types
        pass    # it is a machine learning model
    elif model_name in dl_models:
        file_name = str(base_path / (
                    'pkg/trained_models/' + model_name + '_with_' + vector_type + '_on_' + str(dataset_number) + '.h5'))
        custom_layers = get_custom_layers(model_name, vector_type)
        trained_model = load_model_from_file(file_name, custom_layers)
        return trained_model
    else:
        raise ValueError('The model_name argument should be the name of a machine learning or deep learning classifier')


if __name__ == "__main__":
    dataset_paths = ["Datasets/Sarcasm_Amazon_Review_Corpus", "Datasets/news-headlines-dataset-for-sarcasm-detection",
                     "Datasets/ptacek"]

    # Choose a dataset from the list of valid data sets
    dataset_number = 1
    path_to_dataset_root = dataset_paths[dataset_number]
    print('Selected dataset: ' + path_to_dataset_root[9:])

    vector = 'glove'
    feature_list = []
    model_name = 'attention-lstm'


    model = get_trained_model(path_to_dataset_root, vector, feature_list, model_name, dataset_number)
    # prediction = get_prediction('example string of text', model, dataset_number, model_name)
    while True:
        sentence = input('Type sentence:\n')
        get_attention(sentence, model)

        c = input('Continue? y/n\n')
        if c == 'n':
            break
